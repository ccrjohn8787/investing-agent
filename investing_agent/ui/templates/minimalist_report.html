<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{company}} ({{ticker}}) - Investment Report</title>
    <style>
        /* Reset and Base Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Helvetica Neue', Arial, sans-serif;
            line-height: 1.6;
            color: #2c3e50;
            background: #ffffff;
            padding: 40px 20px;
            max-width: 1200px;
            margin: 0 auto;
        }
        
        /* Typography */
        h1 {
            font-size: 2.5em;
            font-weight: 600;
            color: #1a1a1a;
            margin-bottom: 10px;
            border-bottom: 3px solid #2c3e50;
            padding-bottom: 15px;
        }
        
        h2 {
            font-size: 1.8em;
            font-weight: 600;
            color: #2c3e50;
            margin-top: 40px;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid #e0e0e0;
        }
        
        h3 {
            font-size: 1.3em;
            font-weight: 600;
            color: #34495e;
            margin-top: 25px;
            margin-bottom: 15px;
        }
        
        p {
            margin-bottom: 15px;
            text-align: justify;
            line-height: 1.8;
        }
        
        /* Header Section */
        .header {
            margin-bottom: 40px;
        }
        
        .subtitle {
            color: #7f8c8d;
            font-size: 1.1em;
            margin-bottom: 20px;
        }
        
        /* Key Metrics Box */
        .key-metrics {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            border-radius: 10px;
            margin-bottom: 40px;
        }
        
        .key-metrics h2 {
            color: white;
            border-bottom: 2px solid rgba(255,255,255,0.3);
            margin-top: 0;
        }
        
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 25px;
            margin-top: 25px;
        }
        
        .metric-item {
            text-align: center;
        }
        
        .metric-label {
            font-size: 0.9em;
            opacity: 0.9;
            margin-bottom: 5px;
        }
        
        .metric-value {
            font-size: 1.8em;
            font-weight: 600;
        }
        
        .metric-value.positive {
            color: #00ff88;
        }
        
        .metric-value.negative {
            color: #ff6b6b;
        }
        
        /* Valuation Summary */
        .valuation-summary {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 8px;
            margin-bottom: 40px;
            border-left: 4px solid #667eea;
        }
        
        .valuation-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .valuation-item {
            padding: 15px;
            background: white;
            border-radius: 5px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        
        .valuation-label {
            font-size: 0.9em;
            color: #7f8c8d;
            margin-bottom: 5px;
        }
        
        .valuation-value {
            font-size: 1.4em;
            font-weight: 600;
            color: #2c3e50;
        }
        
        /* Tables */
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: white;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        
        th {
            background: #34495e;
            color: white;
            padding: 12px;
            text-align: left;
            font-weight: 600;
            font-size: 0.9em;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        td {
            padding: 12px;
            border-bottom: 1px solid #ecf0f1;
        }
        
        tr:hover {
            background: #f8f9fa;
        }
        
        tr:last-child td {
            border-bottom: none;
        }
        
        .number {
            text-align: right;
            font-family: 'Monaco', 'Menlo', monospace;
        }
        
        .center {
            text-align: center;
        }
        
        /* Sensitivity Table Special Styling */
        .sensitivity-table th:first-child {
            background: #2c3e50;
        }
        
        .sensitivity-table td:first-child {
            background: #ecf0f1;
            font-weight: 600;
        }
        
        .sensitivity-table .highlight {
            background: #fff3cd;
            font-weight: 600;
        }
        
        /* Quality Score Section */
        .quality-score {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 8px;
            margin-bottom: 40px;
        }
        
        .score-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
        }
        
        .overall-score {
            font-size: 3em;
            font-weight: 600;
            color: #667eea;
        }
        
        .score-label {
            font-size: 1.1em;
            color: #7f8c8d;
        }
        
        .score-breakdown {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }
        
        .score-item {
            padding: 15px;
            background: white;
            border-radius: 5px;
            text-align: center;
        }
        
        .score-dimension {
            font-size: 0.9em;
            color: #7f8c8d;
            margin-bottom: 8px;
        }
        
        .score-value {
            font-size: 1.5em;
            font-weight: 600;
            color: #34495e;
        }
        
        /* Evidence Section */
        .evidence-list {
            list-style: none;
            padding: 0;
        }
        
        .evidence-item {
            padding: 20px;
            background: #f8f9fa;
            border-left: 3px solid #667eea;
            margin-bottom: 15px;
            border-radius: 5px;
        }
        
        .evidence-quote {
            font-style: italic;
            color: #2c3e50;
            margin-bottom: 10px;
            line-height: 1.6;
        }
        
        .evidence-source {
            font-size: 0.9em;
            color: #7f8c8d;
        }
        
        .evidence-confidence {
            display: inline-block;
            padding: 3px 8px;
            border-radius: 3px;
            font-size: 0.85em;
            margin-left: 10px;
        }
        
        .confidence-high {
            background: #d4edda;
            color: #155724;
        }
        
        .confidence-medium {
            background: #fff3cd;
            color: #856404;
        }
        
        .confidence-low {
            background: #f8d7da;
            color: #721c24;
        }
        
        /* Narrative Sections */
        .narrative-section {
            margin-bottom: 40px;
        }
        
        .narrative-content {
            background: white;
            padding: 25px;
            border-radius: 8px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.05);
            line-height: 1.8;
        }
        
        /* Print Styles */
        @media print {
            body {
                padding: 20px;
                font-size: 11pt;
            }
            
            .key-metrics {
                background: #f8f9fa !important;
                color: #2c3e50 !important;
                print-color-adjust: exact;
                -webkit-print-color-adjust: exact;
            }
            
            .key-metrics h2 {
                color: #2c3e50 !important;
            }
            
            .metric-value {
                color: #2c3e50 !important;
            }
            
            h2 {
                page-break-after: avoid;
            }
            
            table {
                page-break-inside: avoid;
            }
            
            .narrative-section {
                page-break-inside: avoid;
            }
        }
        
        /* Responsive Design */
        @media (max-width: 768px) {
            body {
                padding: 20px 10px;
            }
            
            h1 {
                font-size: 2em;
            }
            
            .metrics-grid {
                grid-template-columns: 1fr 1fr;
            }
            
            .valuation-grid {
                grid-template-columns: 1fr;
            }
            
            table {
                font-size: 0.9em;
            }
            
            th, td {
                padding: 8px;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>{{company}} ({{ticker}})</h1>
        <div class="subtitle">Investment Analysis Report • Generated {{date}}</div>
    </div>
    
    <!-- Key Metrics Section -->
    <div class="key-metrics">
        <h2>Key Investment Metrics</h2>
        <div class="metrics-grid">
            <div class="metric-item">
                <div class="metric-label">Current Price</div>
                <div class="metric-value">${{current_price}}</div>
            </div>
            <div class="metric-item">
                <div class="metric-label">Fair Value</div>
                <div class="metric-value">${{fair_value}}</div>
            </div>
            <div class="metric-item">
                <div class="metric-label">Upside/Downside</div>
                <div class="metric-value {{upside_class}}">{{upside}}%</div>
            </div>
            <div class="metric-item">
                <div class="metric-label">Recommendation</div>
                <div class="metric-value">{{rating}}</div>
            </div>
        </div>
    </div>
    
    <!-- Valuation Summary -->
    <div class="valuation-summary">
        <h2>DCF Valuation Summary</h2>
        <div class="valuation-grid">
            <div class="valuation-item">
                <div class="valuation-label">Revenue (TTM)</div>
                <div class="valuation-value">${{revenue}}B</div>
            </div>
            <div class="valuation-item">
                <div class="valuation-label">Revenue Growth</div>
                <div class="valuation-value">{{revenue_growth}}%</div>
            </div>
            <div class="valuation-item">
                <div class="valuation-label">Operating Margin</div>
                <div class="valuation-value">{{operating_margin}}%</div>
            </div>
            <div class="valuation-item">
                <div class="valuation-label">WACC</div>
                <div class="valuation-value">{{wacc}}%</div>
            </div>
            <div class="valuation-item">
                <div class="valuation-label">Terminal Growth</div>
                <div class="valuation-value">{{terminal_growth}}%</div>
            </div>
            <div class="valuation-item">
                <div class="valuation-label">Enterprise Value</div>
                <div class="valuation-value">${{enterprise_value}}B</div>
            </div>
        </div>
    </div>
    
    <!-- Executive Summary -->
    <div class="narrative-section">
        <h2>Executive Summary</h2>
        <div class="narrative-content">
            {{executive_summary}}
        </div>
    </div>
    
    <!-- Detailed Financial Projections -->
    <h2>Detailed Financial Projections</h2>
    <table>
        <thead>
            <tr>
                <th>Year</th>
                <th class="number">Revenue ($M)</th>
                <th class="number">Growth (%)</th>
                <th class="number">Op. Margin (%)</th>
                <th class="number">EBIT ($M)</th>
                <th class="number">Tax ($M)</th>
                <th class="number">NOPAT ($M)</th>
                <th class="number">Reinvest ($M)</th>
                <th class="number">FCFF ($M)</th>
                <th class="number">PV ($M)</th>
            </tr>
        </thead>
        <tbody>
            {{projections_rows}}
        </tbody>
        <tfoot>
            <tr style="font-weight: 600; background: #ecf0f1;">
                <td>Terminal</td>
                <td colspan="8" class="number">Terminal Value</td>
                <td class="number">${{terminal_value}}M</td>
            </tr>
            <tr style="font-weight: 600; background: #e8f4f8;">
                <td>Total</td>
                <td colspan="8" class="number">Enterprise Value</td>
                <td class="number">${{total_enterprise_value}}M</td>
            </tr>
        </tfoot>
    </table>
    
    <!-- Sensitivity Analysis -->
    <h2>Valuation Sensitivity Analysis</h2>
    <table class="sensitivity-table">
        <thead>
            <tr>
                <th>Growth / Margin</th>
                {{sensitivity_margin_headers}}
            </tr>
        </thead>
        <tbody>
            {{sensitivity_rows}}
        </tbody>
    </table>
    
    <!-- Investment Thesis -->
    <div class="narrative-section">
        <h2>Investment Thesis</h2>
        <div class="narrative-content">
            {{investment_thesis}}
        </div>
    </div>
    
    <!-- Financial Analysis -->
    <div class="narrative-section">
        <h2>Financial Analysis</h2>
        <div class="narrative-content">
            {{financial_analysis}}
        </div>
    </div>
    
    <!-- Risk Analysis -->
    <div class="narrative-section">
        <h2>Risk Analysis</h2>
        <div class="narrative-content">
            {{risk_analysis}}
        </div>
    </div>
    
    <!-- Industry Context -->
    <div class="narrative-section">
        <h2>Industry Context</h2>
        <div class="narrative-content">
            {{industry_context}}
        </div>
    </div>
    
    <!-- Quality Score -->
    <div class="quality-score">
        <div class="score-header">
            <div>
                <h2 style="margin-top: 0; border: none;">Report Quality Assessment</h2>
            </div>
            <div>
                <div class="overall-score">{{overall_score}}/10</div>
                <div class="score-label">Overall Score</div>
            </div>
        </div>
        <div class="score-breakdown">
            <div class="score-item">
                <div class="score-dimension">Strategic Narrative</div>
                <div class="score-value">{{narrative_score}}/10</div>
            </div>
            <div class="score-item">
                <div class="score-dimension">Analytical Rigor</div>
                <div class="score-value">{{analytical_score}}/10</div>
            </div>
            <div class="score-item">
                <div class="score-dimension">Industry Context</div>
                <div class="score-value">{{industry_score}}/10</div>
            </div>
            <div class="score-item">
                <div class="score-dimension">Professional Presentation</div>
                <div class="score-value">{{presentation_score}}/10</div>
            </div>
            <div class="score-item">
                <div class="score-dimension">Citation Discipline</div>
                <div class="score-value">{{citation_score}}/10</div>
            </div>
        </div>
    </div>
    
    <!-- Evidence & Citations -->
    <h2>Evidence & Citations</h2>
    <ul class="evidence-list">
        {{evidence_items}}
    </ul>
    
    <!-- Conclusion -->
    <div class="narrative-section">
        <h2>Investment Conclusion</h2>
        <div class="narrative-content">
            {{conclusion}}
        </div>
    </div>
    
    <!-- Footer -->
    <div style="margin-top: 60px; padding-top: 30px; border-top: 1px solid #e0e0e0; color: #7f8c8d; font-size: 0.9em;">
        <p>This report is generated using DCF valuation methodology with comprehensive financial analysis. All projections are based on historical data and analyst estimates. Please conduct your own due diligence before making investment decisions.</p>
        <p style="margin-top: 10px;">Generated on {{date}} • Report Version 1.0</p>
    </div>
</body>
</html>